$(document).ready(function(){function e(){h=!0,$("#prompt").css({visibility:"hidden","transition-duration":".1s"}),$("#avatX").removeClass("select"),$("#avatO").removeClass("select"),$(I[p]).css("border-top","4px solid #0277BD"),$(I[p]).css("border-bottom","4px solid #0277BD"),$(I[x]).css("border-top","4px solid #0277BD"),$(I[x]).css("border-bottom","4px solid #0277BD"),setTimeout(function(){$(".container").css({height:"360","transition-duration":".8s"})},200),setTimeout(function(){$(".dividers").fadeIn(400),$(".hbar1").css({transform:"scaleX(3)","transition-duration":".7s"}),$(".hbar2").css({transform:"scaleX(3)","transition-duration":".7s"}),$(".vbar1").css({transform:"scaleY(3)","transition-duration":".7s"}),$(".vbar2").css({transform:"scaleY(3)","transition-duration":".7s"}),$(".testbox").css("display","inline")},1200),setTimeout(function(){$(I[p]).css("border-bottom","4px solid white")},2e3),setTimeout(function(){t()},2500)}function t(){if(9===m.length)r();else if(7===m.length)d();else if(5===m.length)f();else if(3===m.length)l();else{var e=m[0];v[parseInt(e[0])][parseInt(e[1])]=p,$("#index"+e).addClass(O[p]),m=[]}s()||(m.length>0?n():($(".dividers").fadeOut(250).fadeIn(250).fadeOut(250).fadeIn(250),setTimeout(function(){o()},1e3)))}function n(){$(I[p]).css("border-bottom","4px solid #0277BD"),$(I[x]).css("border-bottom","4px solid white"),b="player"}function i(){$(I[x]).css("border-bottom","4px solid #0277BD"),$(I[p]).css("border-bottom","4px solid white"),b="cpu"}function s(){return v[0][0]===v[0][1]&&v[0][0]===v[0][2]&&0!==v[0][0]?(a("index00","index01","index02"),"row0"):v[1][0]===v[1][1]&&v[1][0]===v[1][2]&&0!==v[1][0]?(a("index10","index11","index12"),"row1"):v[2][0]===v[2][1]&&v[2][0]===v[2][2]&&0!==v[2][0]?(a("index20","index21","index22"),"row2"):v[0][0]===v[1][0]&&v[0][0]===v[2][0]&&0!==v[0][0]?(a("index00","index10","index20"),"col0"):v[0][1]===v[1][1]&&v[0][1]===v[2][1]&&0!==v[0][1]?(a("index01","index11","index21"),"col1"):v[0][2]===v[1][2]&&v[0][2]===v[2][2]&&0!==v[0][2]?(a("index02","index12","index22"),"col2"):v[0][0]===v[1][1]&&v[0][0]===v[2][2]&&0!==v[0][0]?(a("index00","index11","index22"),"diag1"):v[0][2]===v[1][1]&&v[0][2]===v[2][0]&&0!==v[0][2]&&(a("index02","index11","index20"),"diag2")}function a(e,t,n){$("#"+e).fadeOut(400).fadeIn(400).fadeOut(400).fadeIn(400),$("#"+t).fadeOut(400).fadeIn(400).fadeOut(400).fadeIn(400),$("#"+n).fadeOut(400).fadeIn(400).fadeOut(400).fadeIn(400),$(I[x]).css("border-bottom","4px solid #0277BD"),$(I[p]).css("border-bottom","4px solid #0277BD"),setTimeout(function(){o()},2e3)}function o(){v=[[0,0,0],[0,0,0],[0,0,0]],m=["00","01","02","10","11","12","20","21","22"],$(".testbox").removeClass("fa fa-circle-o fa-times"),$(I[p]).css("border-bottom","4px solid white"),setTimeout(function(){r()},1e3)}function r(){g=["00","02","20","22"];var e=Math.floor(4*Math.random()),t=g[e];g.splice(e,1),v[parseInt(t[0])][parseInt(t[1])]=p,$("#index"+t).addClass(O[p]),c(m.indexOf(t)),n()}function d(){var e,t;if(v[1][1]===x||v[0][0]===x||v[0][2]===x||v[2][0]===x||v[2][2]===x){var i=Math.floor(Math.random()*g.length),s=g[i];g.splice(i,1),v[parseInt(s[0])][parseInt(s[1])]=p,$("#index"+s).addClass(O[p]),e=m.indexOf(s)}else{for(var a=[],o=[],r=0;r<3;r++)for(l=0;l<3;l++)v[r][l]===p?(a.push(r),a.push(l)):v[r][l]===x&&(o.push(r),o.push(l));if(a[0]===o[0]){var d=Math.abs(a[0]-2);v[d][a[1]]=p,t=d.toString()+a[1].toString(),$("#index"+t).addClass(O[p]),e=m.indexOf(t)}else if(a[1]===o[1]){var f=Math.abs(a[1]-2);v[a[0]][f]=p,t=a[0].toString()+f.toString(),$("#index"+t).addClass(O[p]),e=m.indexOf(t)}else{for(var a=[],r=0;r<3;r++)for(var l=0;l<3;l++)if(v[r][l]===p){a.push(r),a.push(l);break}var u=[Math.abs(a[0]-2).toString()+a[1].toString(),a[0].toString()+Math.abs(a[1]-2).toString()],i=Math.floor(2*Math.random());$("#index"+u[i]).addClass(O[p]),e=m.indexOf(u[i])}s=g.indexOf(t);g.splice(s,1)}c(e),n()}function f(){var e,t=u(p),n=u(x);if(t){s=t[0][0].toString()+t[0][1].toString();v[t[0][0]][t[0][1]]=p,$("#index"+s).addClass(O[p]),e=m.indexOf(s)}else if(n){s=n[0][0].toString()+n[0][1].toString();v[n[0][0]][n[0][1]]=p,$("#index"+s).addClass(O[p]),e=m.indexOf(s)}else{var i=Math.floor(Math.random()*g.length),s=g[i];g.splice(i,1),v[parseInt(s[0])][parseInt(s[1])]=p,$("#index"+s).addClass(O[p]),e=m.indexOf(s)}c(e)}function l(){var e,t=u(p),n=u(x);if(t){s=t[0][0].toString()+t[0][1].toString();v[t[0][0]][t[0][1]]=p,$("#index"+s).addClass(O[p]),e=m.indexOf(s)}else if(n){s=n[0][0].toString()+n[0][1].toString();v[n[0][0]][n[0][1]]=p,$("#index"+s).addClass(O[p]),e=m.indexOf(s)}else{var i=Math.floor(Math.random()*m.length),s=m[i];v[parseInt(s[0])][parseInt(s[1])]=p,$("#index"+s).addClass(O[p]),e=m.indexOf(s)}c(e)}function c(e){e===m.length-1?m.splice(-1,1):m.splice(e,1)}function u(e){for(s=0;s<3;s++){for(var t=0,n=[],i=0;i<3;i++)0===v[s][i]?n.push([s,i]):v[s][i]===e&&t++;if(1===n.length&&2===t)return n}for(i=0;i<3;i++){for(var t=0,n=[],s=0;s<3;s++)0===v[s][i]?n.push([s,i]):v[s][i]===e&&t++;if(1===n.length&&2===t)return n}var t=0,n=[];if(0===v[0][0]?n.push([0,0]):v[0][0]===e&&t++,0===v[1][1]?n.push([1,1]):v[1][1]===e&&t++,0===v[2][2]?n.push([2,2]):v[2][2]===e&&t++,1===n.length&&2===t)return n;var t=0,n=[];return 0===v[0][2]?n.push([0,2]):v[0][2]===e&&t++,0===v[1][1]?n.push([1,1]):v[1][1]===e&&t++,0===v[2][0]?n.push([2,0]):v[2][0]===e&&t++,1===n.length&&2===t&&n}var x,p,h=!1,b="cpu",g=[],v=[[0,0,0],[0,0,0],[0,0,0]],m=["00","01","02","10","11","12","20","21","22"],O={X:"fa fa-times",O:"fa fa-circle-o"},I={X:".avatarX",O:".avatarO"};$(".avatarX").click(function(){h||(x="X",p="O",e())}),$(".avatarO").click(function(){h||(x="O",p="X",e())}),$(".testbox").click(function(e){if("player"===b){$(e.target).addClass(O[x]);var n=$(e.target).attr("id");if(0===v[parseInt(n[5])][parseInt(n[6])]){if(v[parseInt(n[5])][parseInt(n[6])]=x,m.indexOf(n[5]+n[6])===m.length-1)m.splice(-1,1);else{var a=m.indexOf(n[5]+n[6]);m.splice(a,1)}s()||(i(),setTimeout(function(){t()},1e3))}}})});